NOWAIT ‚Äî —ç—Ç–æ –æ–ø—Ü–∏—è, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å SELECT ... FOR UPDATE, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ–∂–∏–¥–∞–Ω–∏—è, –µ—Å–ª–∏ –Ω—É–∂–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ —É–∂–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –¥—Ä—É–≥–æ–π —Å–µ—Å—Å–∏–µ–π.
üîπ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç NOWAIT?

–í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –∂–¥–∞—Ç—å –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏, Oracle —Å—Ä–∞–∑—É –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É ORA-00054: resource busy and acquire with NOWAIT specified or timeout expired.
‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—Å:

SELECT * FROM employees
WHERE department_id = 10
FOR UPDATE NOWAIT;

üîç –ü—Ä–∏–º–µ—Ä –ø–æ–≤–µ–¥–µ–Ω–∏—è:
‚ñ∂Ô∏è –°–µ—Å—Å–∏—è 1:

BEGIN
  UPDATE employees
  SET salary = salary + 100
  WHERE employee_id = 100;
  -- —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Å—Ç–∞—ë—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç–æ–π (–±–µ–∑ COMMIT)

‚ñ∂Ô∏è –°–µ—Å—Å–∏—è 2:

SELECT * FROM employees
WHERE employee_id = 100
FOR UPDATE NOWAIT;

üîª –†–µ–∑—É–ª—å—Ç–∞—Ç:

ORA-00054: resource busy and acquire with NOWAIT specified or timeout expired

üÜö –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: NOWAIT vs SKIP LOCKED
–û–ø—Ü–∏—è	–ü–æ–≤–µ–¥–µ–Ω–∏–µ
NOWAIT	–°—Ä–∞–∑—É –≤—ã–¥–∞—ë—Ç –æ—à–∏–±–∫—É, –µ—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞
SKIP LOCKED	–ü—Ä–æ—Å—Ç–æ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏, –Ω–µ –≤—ã–¥–∞–≤–∞—è –æ—à–∏–±–æ–∫
üß† –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å NOWAIT?

    –í –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—á–µ—Ä–µ–¥–∏, –≤–æ—Ä–∫–µ—Ä—ã), –≥–¥–µ –æ–∂–∏–¥–∞–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–µ –Ω—É–∂–Ω–æ.

    –î–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è: "–µ—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –∑–∞–Ω—è—Ç–∞ ‚Äî –Ω–µ –∂–¥–∏, –ø—Ä–æ—Å—Ç–æ —Å–∫–∞–∂–∏ –º–Ω–µ".

üö¶ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: WAIT <n> (Oracle 10g+)

SELECT * FROM employees
WHERE employee_id = 100
FOR UPDATE WAIT 5;  -- –ø–æ–¥–æ–∂–¥—ë—Ç –¥–æ 5 —Å–µ–∫—É–Ω–¥

