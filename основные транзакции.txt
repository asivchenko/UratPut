–í Oracle (–∏ –¥—Ä—É–≥–∏—Ö –°–£–ë–î) —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∏–¥–æ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è. –í–æ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ:
üìå 1. –û–±—ã—á–Ω–∞—è (–∏–º–ø–ª–∏—Ü–∏—Ç–Ω–∞—è) —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è

–≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è, –Ω–∞—á–∏–Ω–∞—é—â–∞—è—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å –ø–µ—Ä–≤–æ–≥–æ SQL-–æ–ø–µ—Ä–∞—Ç–æ—Ä–∞, –∏–∑–º–µ–Ω—è—é—â–µ–≥–æ –¥–∞–Ω–Ω—ã–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, INSERT, UPDATE, DELETE).

    –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –Ω–µ—è–≤–Ω–æ

    –ó–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è:

        COMMIT ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

        ROLLBACK ‚Äî –æ—Ç–º–µ–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

üßæ –ü—Ä–∏–º–µ—Ä:

UPDATE employees SET salary = salary + 1000 WHERE id = 101;
COMMIT;

üìå 2. –Ø–≤–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è (explicit transaction)

–í—ã—Ä–∞–∂–∞–µ—Ç—Å—è —è–≤–Ω–æ –≤ PL/SQL –±–ª–æ–∫–∞—Ö —Å –ø–æ–º–æ—â—å—é BEGIN, COMMIT, ROLLBACK.

üßæ –ü—Ä–∏–º–µ—Ä:

BEGIN
  UPDATE accounts SET balance = balance - 100 WHERE id = 1;
  UPDATE accounts SET balance = balance + 100 WHERE id = 2;
  COMMIT;
END;

üìå 3. –ê–≤—Ç–æ–Ω–æ–º–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è (autonomous transaction)

–ö–∞–∫ –æ–±—Å—É–∂–¥–∞–ª–æ—Å—å –≤—ã—à–µ ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –≤–Ω—É—Ç—Ä–∏ –¥—Ä—É–≥–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.

üßæ –ü—Ä–∏–º–µ—Ä:

PRAGMA AUTONOMOUS_TRANSACTION;

üìå 4. –†–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è (distributed transaction)

–û—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö –∫–∞–∫ –µ–¥–∏–Ω–æ–µ —Ü–µ–ª–æ–µ.

    –£–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –¥–≤—É—Ö—Ñ–∞–∑–Ω–æ–≥–æ –∫–æ–º–º–∏—Ç–∞ (2PC)

    –ü—Ä–∏–º–µ—Ä: —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –º–µ–∂–¥—É Oracle –∏ PostgreSQL —á–µ—Ä–µ–∑ dblink

üßæ –ü—Ä–∏–º–µ—Ä:

INSERT INTO local_table VALUES (1, 'local');
INSERT INTO remote_table@dblink VALUES (2, 'remote');
COMMIT;

üìå 5. –ß—Ç–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ (read-only transaction)

–ù–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π ‚Äî —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.

üßæ –ü—Ä–∏–º–µ—Ä:

SET TRANSACTION READ ONLY;
SELECT * FROM employees;
COMMIT;

üìå 6. Savepoint (—Ç–æ—á–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è)

–ü–æ–∑–≤–æ–ª—è—é—Ç –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è –Ω–µ –∫ –Ω–∞—á–∞–ª—É –≤—Å–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –∞ –∫ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–π —Ç–æ—á–∫–µ.

üßæ –ü—Ä–∏–º–µ—Ä:

SAVEPOINT step1;
UPDATE ...;
SAVEPOINT step2;
UPDATE ...;
ROLLBACK TO step1;

