üîπ –ß—Ç–æ —Ç–∞–∫–æ–µ ConcurrentModificationException?

–≠—Ç–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –≤—ã –∏–∑–º–µ–Ω—è–µ—Ç–µ –∫–æ–ª–ª–µ–∫—Ü–∏—é –≤–æ –≤—Ä–µ–º—è –æ–±—Ö–æ–¥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, for-each), –∞ –∏—Ç–µ—Ä–∞—Ç–æ—Ä –∑–∞–º–µ—á–∞–µ—Ç —ç—Ç–æ.
‚ùå –ü—Ä–∏–º–µ—Ä –æ—à–∏–±–∫–∏:

List<String> list = new ArrayList<>();
list.add("A");
list.add("B");

for (String s : list) {
    if (s.equals("A")) {
        list.remove(s);  // ‚ùå ConcurrentModificationException
    }
}

‚úÖ –ö–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å ConcurrentModificationException?
1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Iterator –∏ iterator.remove()

Iterator<String> it = list.iterator();
while (it.hasNext()) {
    if (it.next().equals("A")) {
        it.remove(); // ‚úÖ –±–µ–∑–æ–ø–∞—Å–Ω–æ
    }
}

2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CopyOnWriteArrayList / CopyOnWriteArraySet (–∏–∑ java.util.concurrent)

    –ö–æ–ª–ª–µ–∫—Ü–∏—è –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏, –±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ –∏—Ç–µ—Ä–∞—Ü–∏–∏.

List<String> list = new CopyOnWriteArrayList<>();
list.add("A");
list.add("B");

for (String s : list) {
    if (s.equals("A")) {
        list.remove(s); // ‚úÖ –±–µ–∑–æ–ø–∞—Å–Ω–æ
    }
}

‚ö†Ô∏è –ú–∏–Ω—É—Å: –¥–æ—Ä–æ–≥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è add() ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –¥–ª—è —Ä–µ–¥–∫–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö, –Ω–æ —á–∞—Å—Ç–æ —á–∏—Ç–∞–µ–º—ã—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π.
3. –°–æ–±—Ä–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –∫–æ–ª–ª–µ–∫—Ü–∏—é

List<String> toRemove = new ArrayList<>();
for (String s : list) {
    if (s.equals("A")) {
        toRemove.add(s);
    }
}
list.removeAll(toRemove); // ‚úÖ –±–µ–∑–æ–ø–∞—Å–Ω–æ

4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Stream (Java 8+)

list = list.stream()
           .filter(s -> !s.equals("A"))
           .collect(Collectors.toList());

5. –î–ª—è Map ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Iterator<Map.Entry<K, V>>

Map<String, String> map = new HashMap<>();
map.put("A", "1");
map.put("B", "2");

Iterator<Map.Entry<String, String>> it = map.entrySet().iterator();
while (it.hasNext()) {
    if (it.next().getKey().equals("A")) {
        it.remove(); // ‚úÖ –±–µ–∑–æ–ø–∞—Å–Ω–æ
    }
}

üß† –ü–æ—á–µ–º—É –≤–æ–∑–Ω–∏–∫–∞–µ—Ç ConcurrentModificationException?

    –£ ArrayList, HashMap –∏ –¥—Ä—É–≥–∏—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π –µ—Å—Ç—å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –ø–æ–ª–µ modCount.

    –ï—Å–ª–∏ –æ–Ω–æ –º–µ–Ω—è–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º—è –∏—Ç–µ—Ä–∞—Ü–∏–∏, –∏—Ç–µ—Ä–∞—Ç–æ—Ä —ç—Ç–æ –∑–∞–º–µ—á–∞–µ—Ç –∏ –±—Ä–æ—Å–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ.

    –≠—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º –∑–∞—â–∏—Ç—ã –æ—Ç –Ω–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏.

üìå –í—ã–≤–æ–¥:
–°–ø–æ—Å–æ–±	–ö–æ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è—Ç—å
iterator.remove()	–ü—Ä–∏ –ø—Ä–æ—Å—Ç–æ–º —É–¥–∞–ª–µ–Ω–∏–∏ –≤–æ –≤—Ä–µ–º—è –æ–±—Ö–æ–¥–∞
CopyOnWriteArrayList/Set	–ü—Ä–∏ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–º —á—Ç–µ–Ω–∏–∏ –∏ —Ä–µ–¥–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
–°–±–æ—Ä —É–¥–∞–ª—è–µ–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫	–ï—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ç–µ—Ä–∞—Ç–æ—Ä
Stream + filter()	–ü—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º –ø–æ–¥—Ö–æ–¥–µ (Java 8+)