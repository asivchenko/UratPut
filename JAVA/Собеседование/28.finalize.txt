finalize
üìå –ß—Ç–æ —Ç–∞–∫–æ–µ finalize() –≤ Java?
 
finalize() ‚Äî —ç—Ç–æ –º–µ—Ç–æ–¥ –∫–ª–∞—Å—Å–∞ java.lang.Object, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω –≤ —Ç–≤–æ—ë–º –∫–ª–∞—Å—Å–µ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ—á–∏—Å—Ç–∫–∏ –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º –æ–±—ä–µ–∫—Ç–∞ —Å–±–æ—Ä—â–∏–∫–æ–º –º—É—Å–æ—Ä–∞ (GC).
 
–ü—Ä–∏–º–µ—Ä:
 
@Override
protected void finalize() throws Throwable {
    try {
        System.out.println("Object is being finalized");
    } finally {
        super.finalize();  // –≤–∞–∂–Ω–æ –≤—ã–∑—ã–≤–∞—Ç—å finalize —Å—É–ø–µ—Ä–∫–ª–∞—Å—Å–∞
    }
}
 
–ö–æ–≥–¥–∞ GC —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è —É–Ω–∏—á—Ç–æ–∂–∏—Ç—å –æ–±—ä–µ–∫—Ç (—Ç.–µ. —É–¥–∞–ª–∏—Ç—å –µ–≥–æ –∏–∑ –ø–∞–º—è—Ç–∏), –æ–Ω –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å finalize() –ø–µ—Ä–µ–¥ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ–º –ø–∞–º—è—Ç–∏.
üöÄ –î–ª—è —á–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è finalize()?
 
–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –¥–ª—è:
 
    –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ –Ω–∞ —É—Ä–æ–≤–Ω–µ –û–° (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∑–∞–∫—Ä—ã—Ç—å —Ñ–∞–π–ª –∏–ª–∏ —Å–æ–∫–µ—Ç),
 
    –≤—ã–≤–æ–¥–æ–≤ –≤ –ª–æ–≥ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤.
 
–ù–æ —ç—Ç–æ —É—Å—Ç–∞—Ä–µ–≤—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ:
 
    –Ω–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–∏, —á—Ç–æ finalize() –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω —Å—Ä–∞–∑—É (–∏–ª–∏ –≤–æ–æ–±—â–µ).
 
    –æ–Ω –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏, —Ç–∞–∫ –∫–∞–∫ GC —Ä–µ—à–∞–µ—Ç, –∫–æ–≥–¥–∞ –∏–º–µ–Ω–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å finalize.
 
‚ö† –ü–æ—á–µ–º—É finalize() —Å—á–∏—Ç–∞–µ—Ç—Å—è –æ–ø–∞—Å–Ω—ã–º?
 
1Ô∏è‚É£ –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å ‚Äî –æ–±—ä–µ–∫—Ç –º–æ–∂–µ—Ç –¥–æ–ª–≥–æ –∂–∏—Ç—å –≤ –æ—á–µ—Ä–µ–¥–∏ –Ω–∞ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—é.
2Ô∏è‚É£ –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ—Ç–µ—á–∫–∞–º –ø–∞–º—è—Ç–∏, –µ—Å–ª–∏ finalize ¬´–≤–æ–∑—Ä–æ–∂–¥–∞–µ—Ç¬ª –æ–±—ä–µ–∫—Ç (–¥–æ–±–∞–≤–∏—Ç —Å—Å—ã–ª–∫—É –Ω–∞ —Å–µ–±—è –≥–¥–µ-—Ç–æ, —Ç–æ–≥–¥–∞ GC —Å–Ω–æ–≤–∞ –µ–≥–æ –Ω–µ —É–¥–∞–ª–∏—Ç).
3Ô∏è‚É£ –°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏ –∏ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∑–∞–≤–∏—Å–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã.
üèó –ß–µ–º –∑–∞–º–µ–Ω—è—é—Ç finalize()?
 
‚úÖ –î–ª—è –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ (—Ñ–∞–π–ª—ã, —Å–æ–∫–µ—Ç—ã, –ë–î-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è) –≤ Java –∏—Å–ø–æ–ª—å–∑—É—é—Ç:
 
    try-with-resources (–∏–ª–∏ try (Resource r = ...)), –≥–¥–µ –∫–ª–∞—Å—Å —Ä–µ–∞–ª–∏–∑—É–µ—Ç AutoCloseable / Closeable.
 
    –í—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ close().
 
‚úÖ –î–ª—è —Å–ª—É—á–∞–µ–≤, –≥–¥–µ –Ω—É–∂–µ–Ω –±–æ–ª–µ–µ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å, –µ—Å—Ç—å java.lang.ref.Cleaner (Java 9+).
üîç –ò—Ç–æ–≥
finalize()    –°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞
–ú–µ—Ç–æ–¥, –≤—ã–∑—ã–≤–∞–µ–º—ã–π GC –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º –æ–±—ä–µ–∫—Ç–∞.    try-with-resources + AutoCloseable, Cleaner.
–ù–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º, —É—Å—Ç–∞—Ä–µ–ª (deprecated since Java 9).    –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤.
--
