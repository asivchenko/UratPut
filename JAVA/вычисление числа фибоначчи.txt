import java.math.BigInteger;

public class FibIterative {
    public static BigInteger fib(int n) {
        BigInteger a = BigInteger.ZERO;
        BigInteger b = BigInteger.ONE;
        for (int i = 0; i < n; i++) {   // n ÑˆÐ°Ð³Ð¾Ð²
            BigInteger tmp = a.add(b);
            a = b;
            b = tmp;
        }
        return a;                       // Ð¿Ð¾ÑÐ»Ðµ n ÑˆÐ°Ð³Ð¾Ð² a == F(n)
    }

    public static void main(String[] args) {
        int n = 100;
        System.out.println("F(" + n + ") = " + fib(n)); // 354224848179261915075
    }
}

Ð‘Ñ‹ÑÑ‚Ñ€ÐµÐµ? ÐÐ»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼ Â«fast-doublingÂ»

Ð—Ð° O(logâ¡n)O(logn) ÑƒÐ¼Ð½Ð¾Ð¶ÐµÐ½Ð¸Ð¹:

import java.math.BigInteger;

public class FibFastDoubling {
    private static BigInteger[] fibPair(int n) {
        if (n == 0) return new BigInteger[] {BigInteger.ZERO, BigInteger.ONE};

        BigInteger[] p = fibPair(n / 2);
        BigInteger a = p[0];           // F(k)
        BigInteger b = p[1];           // F(k+1)

        // Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÑÐµÐ¼ F(2k) Ð¸ F(2k+1)
        BigInteger c = a.multiply(b.shiftLeft(1).subtract(a)); // F(2k)
        BigInteger d = a.pow(2).add(b.pow(2));                 // F(2k+1)

        if (n % 2 == 0)
            return new BigInteger[] {c, d};
        else
            return new BigInteger[] {d, c.add(d)};
    }

    public static BigInteger fib(int n) { return fibPair(n)[0]; }

    public static void main(String[] args) {
        System.out.println(fib(100));
    }
}

ÐŸÐ¾Ð»ÐµÐ·Ð½Ñ‹Ðµ Ñ„Ð°ÐºÑ‚Ñ‹
n-Ð¹ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚	ÐšÐ¾Ð»-Ð²Ð¾ Ñ†Ð¸Ñ„Ñ€	ÐŸÑ€Ð¸Ð¼ÐµÑ€Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ (iter.)*
100	21	< 1 Ð¼Ñ
1 000	209	~0.1 Ð¼Ñ
10 000	2 090	~1 Ð¼Ñ

*-Ð½Ð° ÑÐ¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð¹ JVM; fast-doubling Ð¿Ð¾Ñ‡Ñ‚Ð¸ Ð½Ðµ Ð·Ð°Ð²Ð¸ÑÐ¸Ñ‚ Ð¾Ñ‚ n.

Ð¢Ð°Ðº Ñ‡Ñ‚Ð¾ Ð´Ð»Ñ Â«100-Ð³Ð¾ Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸ÑÂ» Ñ€ÑÐ´Ð° Ð¤Ð¸Ð±Ð¾Ð½Ð°Ñ‡Ñ‡Ð¸ Ð²Ñ‹ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚Ðµ Ð¸Ð¼ÐµÐ½Ð½Ð¾
354 224 848 179 261 915 075.
Ð’Ñ‹ ÑÐºÐ°Ð·Ð°Ð»Ð¸:
Ð¿Ð¾ÑÑÐ½Ð¸Ñ‚Ðµ Ð°Ð»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼ Ð±Ñ‹ÑÑ‚Ñ€ÐµÐµ
ChatGPT ÑÐºÐ°Ð·Ð°Ð»:

ÐšÐ¾Ð½ÐµÑ‡Ð½Ð¾! ÐÐ»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼ fast doubling (Ð±Ñ‹ÑÑ‚Ñ€Ð¾Ðµ ÑƒÐ´Ð²Ð¾ÐµÐ½Ð¸Ðµ) â€” ÑÑ‚Ð¾ Ð¾Ñ‡ÐµÐ½ÑŒ ÑÑ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ñ‹Ð¹ ÑÐ¿Ð¾ÑÐ¾Ð± Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ñ Ñ‡Ð¸ÑÐµÐ» Ð¤Ð¸Ð±Ð¾Ð½Ð°Ñ‡Ñ‡Ð¸ Ð·Ð° O(logâ€¯n) Ð²Ð¼ÐµÑÑ‚Ð¾ Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ñ… O(n). Ð”Ð°Ð²Ð°Ð¹Ñ‚Ðµ Ñ€Ð°Ð·Ð±ÐµÑ€ÐµÐ¼ ÐµÐ³Ð¾ Ð¿Ð¾ ÑˆÐ°Ð³Ð°Ð¼:
ðŸ” Ð˜Ð´ÐµÑ Ð°Ð»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼Ð°

ÐžÐ½ Ð¾ÑÐ½Ð¾Ð²Ð°Ð½ Ð½Ð° ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ñ… Ð¼Ð°Ñ‚ÐµÐ¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ñ„Ð¾Ñ€Ð¼ÑƒÐ»Ð°Ñ…, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÑŽÑ‚ Ð²Ñ‹Ñ‡Ð¸ÑÐ»Ð¸Ñ‚ÑŒ F(2k)F(2k) Ð¸ F(2k+1)F(2k+1) Ñ‡ÐµÑ€ÐµÐ· F(k)F(k) Ð¸ F(k+1)F(k+1):
F(2k)=F(k)â‹…[2â‹…F(k+1)âˆ’F(k)]
F(2k)=F(k)â‹…[2â‹…F(k+1)âˆ’F(k)]
F(2k+1)=F(k)2+F(k+1)2
F(2k+1)=F(k)2+F(k+1)2
ðŸ” Ð ÐµÐºÑƒÑ€ÑÐ¸Ð²Ð½Ñ‹Ð¹ Ð¿Ð¾Ð´Ñ…Ð¾Ð´ (Ñ ÐºÑÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ Ð²Ð½ÑƒÑ‚Ñ€Ð¸ ÑÑ‚ÐµÐºÐ°)

Ð’Ð¼ÐµÑÑ‚Ð¾ Ñ‚Ð¾Ð³Ð¾ Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¸Ð´Ñ‚Ð¸ Ð¾Ñ‚ Ð½ÑƒÐ»Ñ Ð´Ð¾ n ÐºÐ°Ðº Ð² Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ð¼ Ñ†Ð¸ÐºÐ»Ðµ, Ð¼Ñ‹:

    Ð”ÐµÐ»Ð°ÐµÐ¼ Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ n Ð½Ð° 2 (Ñ€ÐµÐºÑƒÑ€ÑÐ¸Ð²Ð½Ð¾).

    Ð˜Ð· Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð¸Ñ… Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹ F(k)F(k) Ð¸ F(k+1)F(k+1) Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ F(2k)F(2k), F(2k+1)F(2k+1).

    Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ Ð½ÑƒÐ¶Ð½ÑƒÑŽ Ð¿Ð°Ñ€Ñƒ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ð¹.

ðŸ’¡ ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð½Ð° Ñ€ÑƒÐºÐ°Ñ…

Ð”Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð¼, Ñ‚Ñ‹ Ñ…Ð¾Ñ‡ÐµÑˆÑŒ Ð½Ð°Ð¹Ñ‚Ð¸ F(6):

    Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° Ð´ÐµÐ»Ð¸Ð¼ 6 / 2 = 3, Ð¸Ð´ÐµÐ¼ Ð²Ð³Ð»ÑƒÐ±ÑŒ â€” Ð½ÑƒÐ¶Ð½Ð¾ Ð½Ð°Ð¹Ñ‚Ð¸ F(3)F(3) Ð¸ F(4)F(4)

    Ð§Ñ‚Ð¾Ð±Ñ‹ Ð½Ð°Ð¹Ñ‚Ð¸ F(3)F(3), Ð´ÐµÐ»Ð¸Ð¼ 3 / 2 = 1, Ð¸Ð´ÐµÐ¼ Ð´Ð°Ð»ÑŒÑˆÐµ: Ð¸Ñ‰ÐµÐ¼ F(1)F(1) Ð¸ F(2)F(2)

    Ð F(1)=1F(1)=1, F(2)=1F(2)=1

    Ð¡ ÑÑ‚Ð¾Ð³Ð¾ Ð¼Ð¾Ð¼ÐµÐ½Ñ‚Ð° Ð½Ð°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ ÑÐ¾Ð±Ð¸Ñ€Ð°Ñ‚ÑŒ Ð²Ð²ÐµÑ€Ñ…:

        Ð¸Ð· F(1)F(1) Ð¸ F(2)F(2) Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ F(2)=1F(2)=1, F(3)=2F(3)=2

        Ð¸Ð· F(3)F(3) Ð¸ F(4)F(4) Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ F(6)=8F(6)=8

ðŸ”§ ÐšÐ¾Ð´ ÐµÑ‰Ñ‘ Ñ€Ð°Ð· Ñ Ð¿Ð¾ÑÑÐ½ÐµÐ½Ð¸ÑÐ¼Ð¸

// Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ð¼Ð°ÑÑÐ¸Ð² [F(n), F(n+1)]
private static BigInteger[] fibPair(int n) {
    if (n == 0) return new BigInteger[] {BigInteger.ZERO, BigInteger.ONE};

    BigInteger[] p = fibPair(n / 2);
    BigInteger a = p[0]; // F(k)
    BigInteger b = p[1]; // F(k+1)

    // Ð’Ñ‹Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ðµ F(2k) Ð¸ F(2k+1)
    BigInteger c = a.multiply(b.shiftLeft(1).subtract(a)); // c = F(2k)
    BigInteger d = a.pow(2).add(b.pow(2));                 // d = F(2k+1)

    // Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ Ð½ÑƒÐ¶Ð½ÑƒÑŽ Ð¿Ð°Ñ€Ñƒ
    if (n % 2 == 0)
        return new BigInteger[] {c, d};        // ÐµÑÐ»Ð¸ n Ñ‡ÐµÑ‚Ð½Ð¾Ðµ
    else
        return new BigInteger[] {d, c.add(d)}; // ÐµÑÐ»Ð¸ Ð½ÐµÑ‡ÐµÑ‚Ð½Ð¾Ðµ
}

// Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ð¿ÐµÑ€Ð²ÑƒÑŽ Ñ‡Ð°ÑÑ‚ÑŒ Ð¿Ð°Ñ€Ñ‹: F(n)
public static BigInteger fib(int n) {
    return fibPair(n)[0];
}

ðŸ“ˆ ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ Ð±Ñ‹ÑÑ‚Ñ€ÐµÐµ?

    ÐžÐ±Ñ‹Ñ‡Ð½Ñ‹Ð¹ Ð°Ð»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼ ÑÑ‡Ð¸Ñ‚Ð°ÐµÑ‚ ÐºÐ°Ð¶Ð´Ð¾Ðµ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐµ Ñ‡Ð¸ÑÐ»Ð¾, Ð¸ Ñƒ Ð½ÐµÐ³Ð¾ Ð»Ð¸Ð½ÐµÐ¹Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ.

    Ð—Ð´ÐµÑÑŒ Ð¼Ñ‹ Ð²Ð´Ð²Ð¾Ðµ ÑÐ¾ÐºÑ€Ð°Ñ‰Ð°ÐµÐ¼ n Ð¿Ñ€Ð¸ ÐºÐ°Ð¶Ð´Ð¾Ð¼ ÑˆÐ°Ð³Ðµ â†’ Ð³Ð»ÑƒÐ±Ð¸Ð½Ð° ÑÑ‚ÐµÐºÐ° = logâ‚‚(n)

    Ð’Ñ‹Ð·Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð²ÑÐµÐ³Ð¾ Ð¾ÐºÐ¾Ð»Ð¾ logâ‚‚(n) Ñ€ÐµÐºÑƒÑ€ÑÐ¸Ð¹, Ð¸ ÐºÐ°Ð¶Ð´Ð°Ñ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ ÑƒÐ¼Ð½Ð¾Ð¶ÐµÐ½Ð¸Ð¹/ÑÐ»Ð¾Ð¶ÐµÐ½Ð¸Ð¹.

âœ… Ð’Ñ‹Ð²Ð¾Ð´

ÐÐ»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼ fast doubling:

    Ð Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð·Ð° O(logâ€¯n) Ð¿Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸.

    ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ð¾ Ð¿Ð¾Ð´Ñ…Ð¾Ð´Ð¸Ñ‚ Ð´Ð»Ñ Ð¾Ñ‡ÐµÐ½ÑŒ Ð±Ð¾Ð»ÑŒÑˆÐ¸Ñ… n (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, 1 000 000 Ð¸ Ð±Ð¾Ð»ÑŒÑˆÐµ).

    ÐÐµ Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð²ÑÐµÐ³Ð¾ Ñ€ÑÐ´Ð°.

    Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¼Ð°Ñ‚ÐµÐ¼Ð°Ñ‚Ð¸ÐºÑƒ Ð¸ Ñ€ÐµÐºÑƒÑ€ÑÐ¸ÑŽ.